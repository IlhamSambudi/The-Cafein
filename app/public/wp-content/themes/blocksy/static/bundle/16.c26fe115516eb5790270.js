(window.blocksyJsonP=window.blocksyJsonP||[]).push([[16],{32:function(e,t,r){"use strict";r.r(t),r.d(t,"mount",(function(){return d}));var i=r(3),a=r.n(i),n=r(0),o=r.n(n);let c=null;const s={},l=e=>{let{variation:t,productId:r,isQuickView:i}=e,a=new URL(ct_localizations.ajax_url),n=new URLSearchParams(a.search.slice(1));return n.append("action","blocksy_get_product_view_for_variation"),n.append("variation_id",t.variation_id),n.append("product_id",r),n.append("is_quick_view",i),a.search="?"+n.toString(),a.toString()},d=e=>{a.a&&a.a.fn&&a.a.fn.wc_variations_image_update&&(c=a.a.fn.wc_variations_image_update,a.a.fn.wc_variations_image_update=function(t){const r=e.closest(".product").querySelector(".woocommerce-product-gallery");let i=r.closest(".type-product"),a="no",n=i.id.replace("product-","");n||(n=r.closest('[class*="ct-quick-view"]').querySelector("[data-product_id]").dataset.product_id,n&&(a="yes"));const c=JSON.parse(e.dataset.product_variations);let d=!1,u=!1,_=!1;if(c&&(d=!!t.variation_id&&c.find(e=>{let{variation_id:r}=e;return parseInt(r)===parseInt(t.variation_id)}),u=!!r.dataset.currentVariation&&c.find(e=>{let{variation_id:t}=e;return parseInt(t)===parseInt(r.dataset.currentVariation)}),_=r.querySelector(".flexy-items")&&(!u||u&&r.querySelector(`.flexy-items [srcset*="${u.image.src}"]`)&&"default"===u.blocksy_gallery_source&&[...r.querySelector(".flexy-items").children].indexOf(r.querySelector(`.flexy-items [srcset*="${u.image.src}"]`).closest("div"))>0)),!t.variation_id&&!r.dataset.currentVariation)return;if(parseInt(t.variation_id)===parseInt(r.dataset.currentVariation))return;if(t.variation_id?r.dataset.currentVariation=t.variation_id:r.removeAttribute("data-current-variation"),u&&d&&"default"===d.blocksy_gallery_source&&"default"===u.blocksy_gallery_source&&d.image_id===u.image_id)return;if(c&&r.querySelector("[data-flexy]")&&_&&(!d||"default"===d.blocksy_gallery_source)){let e=null,i=0;t&&(e=r.querySelector(`.flexy-items [srcset*="${t.image.src}"]`),e&&(i=[...r.querySelector(".flexy-items").children].indexOf(e.closest("div"))));const a=r.querySelector(".flexy-pills > *").children[i];if((!t||t&&e)&&a)return r.querySelector("[data-flexy]").dataset.flexy.indexOf("no")>-1?(r.querySelector("[data-flexy]").forcedMount&&r.querySelector("[data-flexy]").forcedMount(),void setTimeout(()=>{a.click()},500)):void a.click()}r.removeAttribute("style"),requestAnimationFrame(()=>{r.dataset.state="loading"});let y=c.find(e=>s[l({variation:e,productId:n,isQuickView:a})]&&e.image_id===t.image_id&&"default"===t.blocksy_gallery_source&&"default"===e.blocksy_gallery_source);var f;(f=l({variation:y||t,productId:n,isQuickView:a}),s[f]?new Promise(e=>{e(s[f]),s[f]=s[f].clone()}):new Promise(e=>fetch(f).then(t=>{e(t),s[f]=t.clone()}))).then(e=>e.json()).then(e=>{let{success:t,data:i}=e;if(!t)return;const a=document.createElement("div");a.innerHTML=i.html,r.innerHTML=a.firstElementChild.innerHTML,r.hasLazyLoadClickHoverListener=!1,setTimeout(()=>{o.a.trigger("blocksy:frontend:init"),r.removeAttribute("data-state")})})})}}}]);